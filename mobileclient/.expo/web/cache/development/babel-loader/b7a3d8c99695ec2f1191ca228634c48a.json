{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useState } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Modal from \"react-native-web/dist/exports/Modal\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport { Button, IconButton, Text } from 'react-native-paper';\nimport * as SecureStore from 'expo-secure-store';\nimport BarCodeScannerComponent from \"./barcodescanner\";\nimport MealSearchBarComponent from \"./mealsearchbar\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nvar AddMealComponent = function AddMealComponent(_ref) {\n  var setShowAddMeal = _ref.setShowAddMeal,\n      setMeals = _ref.setMeals,\n      meals = _ref.meals,\n      meal = _ref.meal,\n      setMeal = _ref.setMeal,\n      updateDiary = _ref.updateDiary;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      showBarCodeScanner = _useState2[0],\n      setShowBarCodeScanner = _useState2[1];\n\n  var updateMeals = function updateMeals() {\n    var newMeals = [].concat(_toConsumableArray(meals), [meal]);\n    updateDiary(newMeals);\n  };\n\n  var countCalories = function countCalories() {\n    return Math.round(meal.weight / 100 * (meal.carbs * 4 + meal.fat * 9 + meal.protein * 4));\n  };\n\n  var addMealToLocalStorage = function addMealToLocalStorage() {\n    var localStorageMeals, localStorageMealsParsed, mealInStorage;\n    return _regeneratorRuntime.async(function addMealToLocalStorage$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _regeneratorRuntime.awrap(SecureStore.getItemAsync('meals'));\n\n          case 2:\n            localStorageMeals = _context.sent;\n            console.log(localStorageMeals);\n\n            if (localStorageMeals) {\n              _context.next = 7;\n              break;\n            }\n\n            SecureStore.setItemAsync('meals', '[]');\n            return _context.abrupt(\"return\");\n\n          case 7:\n            localStorageMealsParsed = JSON.parse(localStorageMeals);\n            mealInStorage = localStorageMealsParsed.filter(function (element) {\n              return element.name == meal.name;\n            });\n\n            if (!mealInStorage[0]) {\n              _context.next = 11;\n              break;\n            }\n\n            return _context.abrupt(\"return\");\n\n          case 11:\n            SecureStore.setItemAsync('meals', JSON.stringify([].concat(_toConsumableArray(localStorageMealsParsed), [meal])));\n\n          case 12:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  return _jsxs(Modal, {\n    transparent: true,\n    visible: true,\n    children: [_jsx(View, {\n      style: styles.container,\n      children: _jsxs(View, {\n        style: styles.card,\n        children: [_jsx(IconButton, {\n          style: {\n            alignSelf: 'flex-end'\n          },\n          icon: \"window-close\",\n          onPress: function onPress() {\n            setMeal({\n              name: '',\n              weight: 0,\n              carbs: 0,\n              fat: 0,\n              protein: 0\n            });\n            setShowAddMeal(false);\n          }\n        }), _jsx(View, {\n          style: {\n            display: 'flex',\n            flexDirection: 'row'\n          },\n          children: _jsx(MealSearchBarComponent, {\n            meal: meal,\n            setMeal: setMeal\n          })\n        }), _jsxs(View, {\n          style: {\n            alignSelf: 'stretch',\n            flexDirection: 'row',\n            justifyContent: 'space-between'\n          },\n          children: [_jsx(Text, {\n            style: styles.inputDescription,\n            children: \"Weight(g)\"\n          }), _jsx(TextInput, {\n            style: styles.input,\n            onChangeText: function onChangeText(input) {\n              return setMeal(_objectSpread(_objectSpread({}, meal), {}, {\n                weight: +input\n              }));\n            },\n            value: String(meal.weight),\n            placeholder: \"Weight (g)\",\n            keyboardType: \"numeric\"\n          })]\n        }), _jsxs(View, {\n          style: {\n            alignSelf: 'stretch',\n            flexDirection: 'row',\n            justifyContent: 'space-between'\n          },\n          children: [_jsx(Text, {\n            style: styles.inputDescription,\n            children: \"Carbs(g per 100g)\"\n          }), _jsx(TextInput, {\n            style: styles.input,\n            onChangeText: function onChangeText(input) {\n              return setMeal(_objectSpread(_objectSpread({}, meal), {}, {\n                carbs: +input\n              }));\n            },\n            value: String(meal.carbs),\n            placeholder: \"Carbs (g per 100g)\",\n            keyboardType: \"numeric\"\n          })]\n        }), _jsxs(View, {\n          style: {\n            alignSelf: 'stretch',\n            flexDirection: 'row',\n            justifyContent: 'space-between'\n          },\n          children: [_jsx(Text, {\n            style: styles.inputDescription,\n            children: \"Fat(g per 100g)\"\n          }), _jsx(TextInput, {\n            style: styles.input,\n            onChangeText: function onChangeText(input) {\n              return setMeal(_objectSpread(_objectSpread({}, meal), {}, {\n                fat: +input\n              }));\n            },\n            value: String(meal.fat),\n            placeholder: \"Fat (g per 100g)\",\n            keyboardType: \"numeric\"\n          })]\n        }), _jsxs(View, {\n          style: {\n            alignSelf: 'stretch',\n            flexDirection: 'row',\n            justifyContent: 'space-between'\n          },\n          children: [_jsx(Text, {\n            style: styles.inputDescription,\n            children: \"Protein(g per 100g)\"\n          }), _jsx(TextInput, {\n            style: styles.input,\n            onChangeText: function onChangeText(input) {\n              return setMeal(_objectSpread(_objectSpread({}, meal), {}, {\n                protein: +input\n              }));\n            },\n            value: String(meal.protein),\n            placeholder: \"Protein (g per 100g)\",\n            keyboardType: \"numeric\"\n          })]\n        }), _jsxs(View, {\n          style: {\n            flexDirection: 'row',\n            justifyContent: 'center',\n            marginTop: 60\n          },\n          children: [_jsxs(View, {\n            style: styles.calorieCount,\n            children: [_jsx(Text, {\n              style: {\n                fontWeight: 'bold'\n              },\n              children: \"Calories in the meal\"\n            }), _jsx(Text, {\n              children: countCalories()\n            })]\n          }), _jsx(Button, {\n            style: styles.flexBttn,\n            color: \"darkviolet\",\n            mode: \"contained\",\n            onPress: function onPress() {\n              return setShowBarCodeScanner(true);\n            },\n            children: \"Scan\"\n          }), _jsx(Button, {\n            style: styles.flexBttn,\n            color: \"darkviolet\",\n            mode: \"contained\",\n            onPress: function onPress() {\n              if (meal.weight == 0) {\n                alert(\"Please, set value for food weight.\");\n                return;\n              }\n\n              if (meal.name.length === 0) {\n                alert(\"Please, fill in meal name in order to add meal\");\n                return;\n              }\n\n              addMealToLocalStorage();\n              updateMeals();\n              setMeal({\n                name: '',\n                weight: 0,\n                carbs: 0,\n                fat: 0,\n                protein: 0\n              });\n              setShowAddMeal(false);\n            },\n            children: \"Add Meal\"\n          })]\n        })]\n      })\n    }), showBarCodeScanner && _jsx(Modal, {\n      children: _jsx(BarCodeScannerComponent, {\n        setMeal: setMeal,\n        setShowBarCodeScanner: setShowBarCodeScanner\n      })\n    })]\n  });\n};\n\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: 'rgba(0,0,0,0.5)'\n  },\n  card: {\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: 'white',\n    padding: 20,\n    borderRadius: 5\n  },\n  input: {\n    height: 40,\n    width: 50,\n    margin: 12,\n    borderBottomWidth: 1.3,\n    borderColor: 'darkviolet',\n    padding: 10\n  },\n  nameInput: {\n    height: 40,\n    width: 300,\n    margin: 12,\n    borderBottomWidth: 1.3,\n    borderColor: 'darkviolet',\n    padding: 10\n  },\n  inputDescription: {\n    alignSelf: 'flex-end',\n    margin: 12,\n    fontSize: 23\n  },\n  flexBttn: {\n    marginRight: 20\n  },\n  calorieCount: {\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    marginHorizontal: 10\n  }\n});\nexport default AddMealComponent;","map":{"version":3,"sources":["/home/dzony/Documents/Site/calorienotes/mobileclient/components/addmeal.tsx"],"names":["React","useState","Button","IconButton","Text","SecureStore","BarCodeScannerComponent","MealSearchBarComponent","AddMealComponent","setShowAddMeal","setMeals","meals","meal","setMeal","updateDiary","showBarCodeScanner","setShowBarCodeScanner","updateMeals","newMeals","countCalories","Math","round","weight","carbs","fat","protein","addMealToLocalStorage","getItemAsync","localStorageMeals","console","log","setItemAsync","localStorageMealsParsed","JSON","parse","mealInStorage","filter","element","name","stringify","styles","container","card","alignSelf","display","flexDirection","justifyContent","inputDescription","input","String","marginTop","calorieCount","fontWeight","flexBttn","alert","length","StyleSheet","create","flex","alignItems","backgroundColor","padding","borderRadius","height","width","margin","borderBottomWidth","borderColor","nameInput","fontSize","marginRight","marginHorizontal"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { View, StyleSheet, Modal, TextInput } from 'react-native'\nimport { Button, IconButton, Text, Divider } from 'react-native-paper';\nimport * as SecureStore from 'expo-secure-store'\n\nimport BarCodeScannerComponent from './barcodescanner';\nimport MealSearchBarComponent from './mealsearchbar';\n\nimport { Meal } from '../screens/homescreen';\n\n\ninterface Props {\n    setShowAddMeal: React.Dispatch<React.SetStateAction<boolean>>,\n    setMeals: React.Dispatch<React.SetStateAction<Meal[]>>,\n    meals: Meal[],\n    meal: Meal,\n    setMeal: React.Dispatch<React.SetStateAction<Meal>>,\n    updateDiary: (passedMeals?: Meal[], passedNote?: string) => void,\n}\n\nconst AddMealComponent: React.FC<Props> = (\n    {\n        setShowAddMeal, \n        setMeals, \n        meals, \n        meal, \n        setMeal, \n        updateDiary\n    }) => {\n    const [showBarCodeScanner, setShowBarCodeScanner] = useState<boolean>(false);\n\n\n    const updateMeals = () => {\n        let newMeals:Meal[] = [...meals, meal];\n        updateDiary(newMeals);\n    }\n    const countCalories = () => {\n        return Math.round(meal.weight / 100 * (meal.carbs * 4 + meal.fat * 9 + meal.protein * 4))\n    }\n    const addMealToLocalStorage = async () => {\n        const localStorageMeals = await SecureStore.getItemAsync('meals');\n        console.log(localStorageMeals);\n        if(!localStorageMeals){\n            SecureStore.setItemAsync('meals', '[]')\n            return\n        }\n        const localStorageMealsParsed:Meal[] = JSON.parse(localStorageMeals);\n        const mealInStorage = localStorageMealsParsed.filter(element => element.name == meal.name);\n        if(mealInStorage[0]){\n            return\n        }\n        SecureStore.setItemAsync('meals', JSON.stringify([...localStorageMealsParsed, meal]));\n    }\n\n    return(\n        <Modal transparent visible={true}>\n            <View style={styles.container}>\n                <View style={styles.card}>\n                    <IconButton \n                        style={{alignSelf:'flex-end'}}\n                        icon='window-close' \n                        onPress={() => {\n                            setMeal({\n                                name: '',\n                                weight: 0,\n                                carbs: 0,\n                                fat: 0,\n                                protein: 0,\n                            });\n                            setShowAddMeal(false);\n                        }}\n                    />\n\n                        <View style={{display:'flex', flexDirection: 'row',}}>\n                            <MealSearchBarComponent \n                                meal={meal}\n                                setMeal={setMeal}\n                            />\n                        </View>\n\n                        <View style={{alignSelf:'stretch', flexDirection: 'row',justifyContent:'space-between'}}>\n                        <Text style={styles.inputDescription}>Weight(g)</Text>\n                        <TextInput\n                            style={styles.input}\n                            onChangeText={(input) => setMeal({...meal, weight: +input})}\n                            value={String(meal.weight)}\n                            placeholder='Weight (g)'\n                            keyboardType='numeric'\n                        />\n                        </View>\n                        <View style={{alignSelf:'stretch', flexDirection: 'row',justifyContent:'space-between'}}>\n                        <Text style={styles.inputDescription}>Carbs(g per 100g)</Text>\n                        <TextInput\n                            style={styles.input}\n                            onChangeText={(input) => setMeal({...meal, carbs: +input})}\n                            value={String(meal.carbs)}\n                            placeholder='Carbs (g per 100g)'\n                            keyboardType='numeric'\n                        />\n                        </View>\n                        <View style={{alignSelf:'stretch', flexDirection: 'row',justifyContent:'space-between'}}>\n                        <Text style={styles.inputDescription}>Fat(g per 100g)</Text>\n                        <TextInput\n                            style={styles.input}\n                            onChangeText={(input) => setMeal({...meal, fat: +input})}\n                            value={String(meal.fat)}\n                            placeholder='Fat (g per 100g)'\n                            keyboardType='numeric'\n                        />\n                        </View>\n                        <View style={{alignSelf:'stretch', flexDirection: 'row',justifyContent:'space-between'}}>\n                        <Text style={styles.inputDescription}>Protein(g per 100g)</Text>\n                        <TextInput\n                            style={styles.input}\n                            onChangeText={(input) => setMeal({...meal, protein: +input})}\n                            value={String(meal.protein)}\n                            placeholder='Protein (g per 100g)'\n                            keyboardType='numeric'\n                        />\n                        </View>\n\n                    <View style={{ flexDirection:'row' ,justifyContent:'center', marginTop:60}}>\n                        <View style={styles.calorieCount}>\n                            <Text style={{ fontWeight:'bold' }}>Calories in the meal</Text>\n                            <Text>{countCalories()}</Text>\n                        </View>\n                        <Button \n                            style={styles.flexBttn} \n                            color='darkviolet' \n                            mode='contained'\n                            onPress={() => setShowBarCodeScanner(true)}\n                            >\n                                Scan\n                        </Button>\n                        <Button \n                            style={styles.flexBttn} \n                            color='darkviolet' \n                            mode='contained'\n                            onPress={() => {\n                                if(meal.weight == 0){\n                                    alert(`Please, set value for food weight.`);\n                                    return\n                                }\n                                if(meal.name.length === 0){\n                                    alert(`Please, fill in meal name in order to add meal`);\n                                    return\n                                }\n                                addMealToLocalStorage();\n                                updateMeals();\n                                setMeal({\n                                    name: '',\n                                    weight: 0,\n                                    carbs: 0,\n                                    fat: 0,\n                                    protein: 0,\n                                });\n                                setShowAddMeal(false);\n                            }}\n                            >\n                                Add Meal\n                        </Button>\n                    </View>\n                </View>\n            </View>\n            {showBarCodeScanner && \n                    <Modal>\n                        <BarCodeScannerComponent \n                            setMeal={setMeal}\n                            setShowBarCodeScanner={setShowBarCodeScanner}\n                            />\n                    </Modal>}\n        </Modal>\n    )\n}\n\nconst styles = StyleSheet.create({\n    container: {\n        flex:1,\n        justifyContent: 'center',\n        alignItems: 'center',\n        backgroundColor: 'rgba(0,0,0,0.5)',\n    },\n    card: {\n        display:'flex',\n        justifyContent:'center',\n        alignItems: 'center',\n        backgroundColor: 'white',\n        padding: 20,\n        borderRadius: 5,\n    },\n    input: {\n        height: 40,\n        width: 50,\n        margin: 12,\n        borderBottomWidth: 1.3,\n        borderColor:'darkviolet',\n        padding: 10,\n    },\n    nameInput: {\n        height: 40,\n        width: 300,\n        margin: 12,\n        borderBottomWidth: 1.3,\n        borderColor:'darkviolet',\n        padding: 10,\n    },\n    inputDescription: {\n        alignSelf:'flex-end',\n        margin:12, \n        fontSize:23,\n    },\n    flexBttn: {\n        marginRight: 20,\n    },\n    calorieCount: {\n        display: 'flex',\n        justifyContent: 'center',\n        alignItems: 'center',\n        marginHorizontal:10,\n    }\n})\n\n\nexport default AddMealComponent"]},"metadata":{},"sourceType":"module"}